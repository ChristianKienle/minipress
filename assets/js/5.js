(window.webpackJsonp=window.webpackJsonp||[]).push([[5],{39:function(t,e,s){"use strict";s.r(e);var a={},n=s(0),r=Object(n.a)(a,(function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("MpLayoutManager",[s("div",{staticClass:"page-content"},[s("h1",{attrs:{id:"internals"}},[s("router-link",{staticClass:"header-anchor",attrs:{to:"#internals","aria-hidden":"true"}},[t._v("#")]),t._v(" Internals")],1),t._v(" "),s("p",[t._v("If you want to know how "),s("em",[t._v("miniPress")]),t._v(" works internally – this guide is for you.")]),t._v(" "),s("blockquote",[s("p",[s("strong",[t._v("A word of caution:")]),t._v("\nThe internals change very frequently as I learn new things. Also – my understanding might be incorrect.")])]),t._v(" "),s("h2",{attrs:{id:"how-pages-come-to-life"}},[s("router-link",{staticClass:"header-anchor",attrs:{to:"#how-pages-come-to-life","aria-hidden":"true"}},[t._v("#")]),t._v(" How Pages come to Life")],1),t._v(" "),s("p",[t._v("Let’s assume that there is a directory called "),s("code",[t._v("pages/")]),t._v(", which contains all of your Markdown files. Each file represents a page. When "),s("em",[t._v("miniPress")]),t._v(" is started, it looks in that directory and finds all Markdown files. It makes a note of each file and basically just renders the Markdown file using it’s custom Markdown setup. So basically this is what happens ("),s("em",[t._v("pseudocode")]),t._v("):")]),t._v(" "),s("div",{pre:!0,attrs:{class:"minipress-highlight","data-lang":"js"}},[s("pre",{pre:!0,attrs:{class:"minipress-highlight-code language-js"}},[s("code",{pre:!0,attrs:{class:"language-js"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" paths "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("findPagesIn")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'pages/'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\npaths"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("forEach")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("path")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Page")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("path"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("render")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")])])])]),s("p",[t._v("The Markdown pipeline is setup in a "),s("strong",[t._v("special way")]),t._v(":")]),t._v(" "),s("ul",[s("li",[s("code",[t._v("render()")]),t._v(" does some preprocessing (extract frontmatter, …) and the renders the page by basically invoking each Markdown(-it)-plugin.")]),t._v(" "),s("li",[t._v("Each Markdown plugin knows which "),s("code",[t._v("Page")]),t._v("-instance it operates on.")]),t._v(" "),s("li",[t._v("Each Markdown plugin does it’s job and then simply sets properties on the page instance as needed.")]),t._v(" "),s("li",[t._v("For example – the headings plugin sets the "),s("code",[t._v("headings")]),t._v("-property on the page instance.")])]),t._v(" "),s("p",[t._v("After the "),s("em",[t._v("initial")]),t._v(" render process the "),s("code",[t._v("Page")]),t._v("-instances are pre-populated with all the data we need.")]),t._v(" "),s("h2",{attrs:{id:"learnings"}},[s("router-link",{staticClass:"header-anchor",attrs:{to:"#learnings","aria-hidden":"true"}},[t._v("#")]),t._v(" Learnings")],1),t._v(" "),s("h3",{attrs:{id:"plugintheme-api"}},[s("router-link",{staticClass:"header-anchor",attrs:{to:"#plugintheme-api","aria-hidden":"true"}},[t._v("#")]),t._v(" Plugin/Theme-API")],1),t._v(" "),s("p",[t._v("Originally I wanted to have a plugin-/theme-API like plugins in Rollup are done:")]),t._v(" "),s("p",[s("strong",[t._v("Custom Theme:")])]),t._v(" "),s("div",{pre:!0,attrs:{class:"minipress-highlight","data-lang":"js"}},[s("pre",{pre:!0,attrs:{class:"minipress-highlight-code language-js"}},[s("code",{pre:!0,attrs:{class:"language-js"}},[t._v("module"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/* my theme implementation goes here */")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])])]),s("p",[s("strong",[t._v("Theme Consumer:")])]),t._v(" "),s("div",{pre:!0,attrs:{class:"minipress-highlight","data-lang":"js"}},[s("pre",{pre:!0,attrs:{class:"minipress-highlight-code language-js"}},[s("code",{pre:!0,attrs:{class:"language-js"}},[s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" CustomTheme "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("require")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v("'my-custom-theme'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n\nmodule"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("exports "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  theme"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" CustomTheme\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")])])])]),s("p",[t._v("However, this has one big disadvantage: "),s("em",[t._v("miniPress")]),t._v(" no longer knows the location of "),s("code",[t._v("CustomTheme")]),t._v(" in the file system. This means that it cannot apply certain conventions for example automatically registering components found in "),s("code",[t._v("components/")]),t._v(". Probably that is why "),s("em",[t._v("VuePress")]),t._v(" requires you to specify plugins by name. It is also possible to pass "),s("em",[t._v("VuePress")]),t._v(" a function as a plugin but I have no idea how they do it.")])])])}),[],!1,null,null,null);e.default=r.exports}}]);